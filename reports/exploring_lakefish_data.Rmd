---
title: "Exploring lakefish data"
author: "Emma Sofie Skarstein and Lyder Iversen"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
library(sf) # for sf objects
library(dplyr) # for smoother dataframe-manipulation
library(here) # for cleaner filepath-handling
library(mapview) # for nice maps
library(ggmap) # also for nice maps
```

First, to download the data, ... 
```{r}
# Include completely minimal script to download data. 
# Considerations: 
#     Which data do we want to look at?
#     Do we want to do any preparation beyond converting to sf-object?

# Load data downloaded in "download.R". Also remove all variables that contain NA-values.
occ <- readRDS(here::here("data","GBIF_download.rds")) %>% 
  dplyr::select_if(~!all(is.na(.)))

occ_sf <- occ %>% 
  st_as_sf(coords = c("decimalLongitude", "decimalLatitude"), crs = 4326) %>%    # Convert to sf object for easier handling. crs = Coordinate Reference System
  st_transform(st_crs(lakes)$epsg) %>%    # Transform coordinate system
  dplyr::select(gbifID, occurrenceID, catalogNumber, geometry, species, taxonKey, datasetKey, locality, municipality, county, countryCode, locationID, eventDate, year, month, day, samplingProtocol, eventID, fieldNumber, recordedBy, dynamicProperties, collectionCode, datasetName, license, institutionCode)    # Select a few of the variables

```

Next, some basic plotting.
```{r}
# Using mapview in the rmd-document does work and produces super nice plot, but it takes absolutely for ever to run.
# mapview(occ_sf)

```
